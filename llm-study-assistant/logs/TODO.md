# 后续优化待办事项

## 视频分析功能 (2025-10-11) - 概要
- [x] **增强视频OCR文本处理能力**：优化对视频OCR提取的原始文本的解析，实现题目与对应选项的准确识别和分割。
- [x] **修复视频分析问答流程**：解决后端无法正确解析LLM输出导致前端显示“解析失败”和“undefined”的问题，确保返回结构化的答案。
- [ ] **统一前端答案展示格式**：按照“题号 + 答案 + 理由（知识库片段）”的格式，清晰、统一地在前端展示分析结果。

---

## 详细任务分解 (2025-10-11)

### **Phase 1: 后端 - 视频文本解析 (`app/video_processing.py`)**
- [x] **任务1.1**: 设计题目与选项的识别规则（建议使用正则表达式）。
- [x] **任务1.2**: 实现 `parse_ocr_text_to_qa` 函数，将原始OCR文本转换为结构化的Q&A列表。
- [x] **任务1.3**: 将新解析器集成到视频分析API `/recordings/{filename}/analyze` 中。

### **Phase 2: 后端 - RAG问答流程优化 (`app/rag.py`, `app/prompts.py`)**
- [ ] **任务2.1**: 设计并实现一个强制LLM返回JSON格式的新Prompt。
- [ ] **任务2.2**: 在RAG流程中为视频问答增加专门处理分支，调用新Prompt。
- [ ] **任务2.3**: 确保返回给前端的 `AskResponse` 数据模型字段完整，修复 `undefined` 问题。

### **Phase 3: 前端 - 标准化答案展示 (`frontend/index.html`)**
- [ ] **任务3.1**: 修改 `analyzeRecording` JS函数，以解析新的后端响应结构。
- [ ] **任务3.2**: 重构 `answer-box` 的HTML生成逻辑，实现“题号+答案+理由”的格式。
- [ ] **任务3.3**: 增加更友好的前端错误提示。